<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz da Tia: BTS & Doramas</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            margin: 0; display: flex; align-items: center; justify-content: center;
            height: 100vh; overflow: hidden;
            background: #2d0a50 url('bts.jpg') no-repeat center center fixed; 
            background-size: cover;
        }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(45, 10, 80, 0.4); z-index: 1; }
        .quiz-card {
            position: relative; text-align: center; width: 90%; max-width: 450px;
            background: rgba(255, 255, 255, 0.96); padding: 30px; border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.5); z-index: 2;
        }
        h1 { color: #4a148c; font-size: 18px; margin-bottom: 10px; min-height: 45px; }
        
        /* BARRA DE PROGRESSO */
        .progress-container { width: 100%; height: 10px; background: #eee; border-radius: 10px; margin-bottom: 20px; overflow: hidden; }
        .progress-bar { width: 0%; height: 100%; background: #8e44ad; transition: 0.4s; }

        .btn-option { width: 100%; padding: 12px; font-size: 15px; font-weight: bold; color: #333; background: #fff; border: 2px solid #ddd; border-radius: 12px; cursor: pointer; transition: 0.1s; margin-bottom: 8px; }
        .btn-correct { background: #2ecc71 !important; color: white !important; border-color: #27ae60 !important; }
        .btn-wrong { background: #e74c3c !important; color: white !important; border-color: #c0392b !important; }
        
        .rank-title { font-size: 22px; font-weight: bold; color: #4a148c; margin: 15px 0; display: block; }
        .menu-container { position: fixed; top: 15px; right: 15px; z-index: 100; }
        select { padding: 8px; border-radius: 5px; background: #4a148c; color: white; border: 1px solid white; font-weight: bold; }
        .music-control { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .btn-music { background: rgba(128, 0, 128, 0.9); color: white; border: none; padding: 10px; border-radius: 50%; cursor: pointer; width: 55px; height: 55px; font-size: 24px; box-shadow: 0 4px 15px rgba(0,0,0,0.4); display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div class="overlay"></div>

    <audio id="bg-music" loop preload="auto"><source src="bts2.mp3" type="audio/mpeg"></audio>
    <audio id="sound-certo" preload="auto"><source src="acerto.mp3" type="audio/mpeg"></audio>
    <audio id="sound-errado" preload="auto"><source src="erro.mp3" type="audio/mpeg"></audio>

    <div class="menu-container">
        <select id="select-nivel">
            <option value="1">BTS: N√≠vel F√°cil</option>
            <option value="2">BTS: N√≠vel M√©dio</option>
            <option value="3">BTS: N√≠vel Expert</option>
            <option value="4">Doramas: Rom√¢nticos 1</option>
            <option value="5">Doramas: Rom√¢nticos 2</option>
        </select>
    </div>

    <div class="quiz-card" id="main-card">
        <h1 id="question-text">Iniciando o Quiz...</h1>
        <div class="progress-container"><div class="progress-bar" id="progress-bar"></div></div>
        <div id="options-box"></div>
    </div>

    <div class="music-control">
        <button class="btn-music" id="btn-toggle-music"><span id="music-icon">üîá</span></button>
    </div>

    <script>
        const db = {
            1: [{q:"Quantos integrantes tem o BTS?",options:["7","9"],correct:"7"},{q:"Qual o nome do fandom do BTS?",options:["ARMY","Stay"],correct:"ARMY"},{q:"Qual a cor oficial do grupo?",options:["Roxo","Verde"],correct:"Roxo"},{q:"Quem √© o integrante mais novo (maknae)?",options:["Jungkook","Jin"],correct:"Jungkook"},{q:"Em qual pa√≠s nasceu o BTS?",options:["Coreia do Sul","China"],correct:"Coreia do Sul"},{q:"Qual o nome do l√≠der do grupo?",options:["RM","J-Hope"],correct:"RM"},{q:"Quem √© o integrante mais velho?",options:["Jin","Suga"],correct:"Jin"},{q:"Qual dessas m√∫sicas √© do BTS?",options:["Dynamite","Solo"],correct:"Dynamite"},{q:"O BTS estreou em qual ano?",options:["2013","2015"],correct:"2013"},{q:"Qual o nome real do V?",options:["Kim Taehyung","Park Jimin"],correct:"Kim Taehyung"}],
            2: [{q:"Qual integrante √© o 'Worldwide Handsome'?",options:["Jin","V"],correct:"Jin"},{q:"Qual o nome art√≠stico de Min Yoongi?",options:["Suga","RM"],correct:"Suga"},{q:"Qual o nome do reality de viagens deles?",options:["Bon Voyage","In the Soop"],correct:"Bon Voyage"},{q:"Quem lan√ßou o √°lbum 'Indigo'?",options:["RM","Jimin"],correct:"RM"},{q:"Qual o personagem do Jungkook no BT21?",options:["Cooky","Tata"],correct:"Cooky"},{q:"Qual integrante √© o 'Sol' do grupo?",options:["J-Hope","RM"],correct:"J-Hope"},{q:"Quem canta o solo 'Serendipity'?",options:["Jimin","V"],correct:"Jimin"},{q:"Jimin nasceu em qual cidade?",options:["Busan","Seoul"],correct:"Busan"},{q:"Qual integrante toca saxofone?",options:["V","Suga"],correct:"V"},{q:"Qual a empresa do BTS?",options:["Bighit (HYBE)","SM"],correct:"Bighit (HYBE)"}],
            3: [{q:"Em que dia exato o BTS estreou?",options:["13 de Junho","12 de Junho"],correct:"13 de Junho"},{q:"O que significa 'Bangtan Sonyeondan'?",options:["Escoteiros √† Prova de Balas","Garotos de Ouro"],correct:"Escoteiros √† Prova de Balas"},{q:"Qual o nome do cachorro do V?",options:["Yeontan","Holly"],correct:"Yeontan"},{q:"Onde foi o show gratuito 'Yet to Come'?",options:["Busan","Seoul"],correct:"Busan"},{q:"Qual m√∫sica eles tocaram no Grammy 2022?",options:["Butter","On"],correct:"Butter"},{q:"Qual integrante produziu 'Wine' da Suran?",options:["Suga","RM"],correct:"Suga"},{q:"Quem lan√ßou a mixtape 'Hope World'?",options:["J-Hope","Jungkook"],correct:"J-Hope"},{q:"Qual dorama o V participou como ator?",options:["Hwarang","Goblin"],correct:"Hwarang"},{q:"Qual o nome do solo do Jin de 2022?",options:["The Astronaut","Abyss"],correct:"The Astronaut"},{q:"Qual o nome da m√∫sica de debut do BTS?",options:["No More Dream","Danger"],correct:"No More Dream"}],
            4: [{q:"Em 'Pousando no Amor', ela cai onde?",options:["Coreia do Norte","Jap√£o"],correct:"Coreia do Norte"},{q:"Dorama da advogada que ama baleias?",options:["Uma Advogada Extraordin√°ria","Vincenzo"],correct:"Uma Advogada Extraordin√°ria"},{q:"Qual a profiss√£o dela em Hometown Cha-Cha-Cha?",options:["Dentista","M√©dica"],correct:"Dentista"},{q:"Dorama com os rapazes ricos do F4?",options:["Boys Over Flowers","The Heirs"],correct:"Boys Over Flowers"},{q:"Quem √© o Rei em 'O Rei Eterno'?",options:["Lee Min-ho","Gong Yoo"],correct:"Lee Min-ho"},{q:"Dorama sobre um hotel para fantasmas?",options:["Hotel del Luna","Oh My Ghost"],correct:"Hotel del Luna"},{q:"Em 'Tudo Bem N√£o Ser Normal', ela escreve o qu√™?",options:["Livros Infantis","Poesia"],correct:"Livros Infantis"},{q:"Dorama sobre maquiagem e autoestima?",options:["Beleza Verdadeira","Dorama"],correct:"Beleza Verdadeira"},{q:"Em 'Descendentes do Sol', ele √©...",options:["Capit√£o do Ex√©rcito","Chefe"],correct:"Capit√£o do Ex√©rcito"},{q:"O dorama 'Herdeiros' se passa onde?",options:["Na Escola","Na Fazenda"],correct:"Na Escola"}],
            5: [{q:"Dorama sobre criar uma empresa (Start-Up)?",options:["Apostando Alto","Vincenzo"],correct:"Apostando Alto"},{q:"Vincenzo Cassano veio de qual pa√≠s?",options:["It√°lia","Espanha"],correct:"It√°lia"},{q:"Dorama da mulher com super for√ßa?",options:["Strong Woman Do Bong-soon","The Glory"],correct:"Strong Woman Do Bong-soon"},{q:"Onde trabalham em 'Pretendente Surpresa'?",options:["Empresa de Alimentos","Banco"],correct:"Empresa de Alimentos"},{q:"Dorama de um alien√≠gena que vive na Terra?",options:["Meu Amor das Estrelas","Goblin"],correct:"Meu Amor das Estrelas"},{q:"Bar do protagonista em Itaewon Class?",options:["DanBam","Itaewon House"],correct:"DanBam"},{q:"Qual dorama tem a 'Secret√°ria Kim'?",options:["O que houve com a Sec. Kim?","Hwarang"],correct:"O que houve com a Sec. Kim?"},{q:"Qual dorama foca no mundo da moda?",options:["Now We Are Breaking Up","Startup"],correct:"Now We Are Breaking Up"},{q:"Nome da herdeira em Pousando no Amor?",options:["Yoon Se-ri","Se-ri Park"],correct:"Yoon Se-ri"},{q:"Em 'Nosso Eterno Ver√£o', eles gravam um...",options:["Document√°rio","Filme"],correct:"Document√°rio"}]
        };

        let perguntasAtuais = [];
        let indexAtual = 0;
        let acertos = 0;
        let bloqueado = false;
        let isMusicPlaying = false;

        function mudarNivel() {
            const nivelSelect = document.getElementById('select-nivel');
            if(!nivelSelect) return;
            perguntasAtuais = db[nivelSelect.value];
            indexAtual = 0; acertos = 0;
            load();
        }

        function load() {
            bloqueado = false;
            const optionsBox = document.getElementById('options-box');
            const questionText = document.getElementById('question-text');
            const progressBar = document.getElementById('progress-bar');
            
            if(!optionsBox || !questionText) return;

            optionsBox.innerHTML = "";
            const progresso = (indexAtual / perguntasAtuais.length) * 100;
            progressBar.style.width = progresso + "%";

            if (indexAtual < perguntasAtuais.length) {
                const p = perguntasAtuais[indexAtual];
                questionText.innerText = p.q;
                
                // RESPOSTAS ALEAT√ìRIAS
                let shuffled = [...p.options].sort(() => Math.random() - 0.5);
                
                shuffled.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = 'btn-option';
                    btn.innerText = opt;
                    btn.onclick = () => check(opt, btn);
                    optionsBox.appendChild(btn);
                });
            } else {
                finalizar();
            }
        }

        function check(escolha, btn) {
            if(bloqueado) return;
            bloqueado = true;
            const correta = perguntasAtuais[indexAtual].correct;
            const sfxCerto = document.getElementById('sound-certo');
            const sfxErrado = document.getElementById('sound-errado');
            
            if (escolha === correta) {
                acertos++;
                btn.classList.add('btn-correct');
                if(sfxCerto) { sfxCerto.currentTime = 0; sfxCerto.play().catch(()=>{}); }
            } else {
                btn.classList.add('btn-wrong');
                if(sfxErrado) { sfxErrado.currentTime = 0; sfxErrado.play().catch(()=>{}); }
                Array.from(document.querySelectorAll('.btn-option')).forEach(b => {
                    if(b.innerText === correta) b.classList.add('btn-correct');
                });
            }
            setTimeout(() => { indexAtual++; load(); }, 600);
        }

        function finalizar() {
            const mainCard = document.getElementById('main-card');
            let rank = acertos <= 4 ? "Iniciante üçø" : acertos <= 7 ? "ARMY de Respeito! üíú" : "Expert Total! ‚ú®";
            if(acertos >= 8) lancarConfetes();

            mainCard.innerHTML = `
                <h1>Fim do N√≠vel!</h1>
                <span class="rank-title">${rank}</span>
                <p>Voc√™ acertou <b>${acertos}</b> de 10</p>
                <button class="btn-option" style="background:#4a148c;color:#fff;margin-top:20px" onclick="location.reload()">Jogar de Novo</button>
            `;
        }

        function lancarConfetes() {
            var end = Date.now() + 3000;
            (function frame() {
              confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#8e44ad', '#f1c40f'] });
              confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#8e44ad', '#f1c40f'] });
              if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }

        // ESPERA CARREGAR TUDO ANTES DE INICIAR
        window.addEventListener('load', () => {
            const selectNivel = document.getElementById('select-nivel');
            const btnMusic = document.getElementById('btn-toggle-music');
            const audioBg = document.getElementById('bg-music');
            const musicIcon = document.getElementById('music-icon');

            selectNivel.addEventListener('change', mudarNivel);
            
            btnMusic.addEventListener('click', (e) => {
                e.stopPropagation();
                if (!isMusicPlaying) {
                    audioBg.play().then(() => { isMusicPlaying = true; musicIcon.innerText = "üîä"; }).catch(()=>{});
                } else {
                    audioBg.pause(); isMusicPlaying = false; musicIcon.innerText = "üîá";
                }
            });

            mudarNivel(); // Inicia o jogo
        });
    </script>
</body>
</html>
